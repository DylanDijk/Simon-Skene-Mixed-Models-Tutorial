<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Modified Box Correction | Methods in (Skene &amp; Kenward, 2010)</title>
<meta name="author" content="Dylan Dijk">
<meta name="description" content="3.1 nlme Here we provide a function that calculates the modified box correction from mixed models constructed using the nlme package. The function takes as input two nlme models, the input...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 3 Modified Box Correction | Methods in (Skene &amp; Kenward, 2010)">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 nlme Here we provide a function that calculates the modified box correction from mixed models constructed using the nlme package. The function takes as input two nlme models, the input...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Modified Box Correction | Methods in (Skene &amp; Kenward, 2010)">
<meta name="twitter:description" content="3.1 nlme Here we provide a function that calculates the modified box correction from mixed models constructed using the nlme package. The function takes as input two nlme models, the input...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Methods in (Skene &amp; Kenward, 2010)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">SAS</li>
<li><a class="" href="Modified-Box-Correction-SAS.html"><span class="header-section-number">2</span> Modified Box Correction</a></li>
<li class="book-part">R</li>
<li><a class="active" href="modified-box-correction.html"><span class="header-section-number">3</span> Modified Box Correction</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modified-box-correction" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Modified Box Correction<a class="anchor" aria-label="anchor" href="#modified-box-correction"><i class="fas fa-link"></i></a>
</h1>
<div id="nlme" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> nlme<a class="anchor" aria-label="anchor" href="#nlme"><i class="fas fa-link"></i></a>
</h2>
<p>Here we provide a function that calculates the modified box correction from mixed models constructed using the <strong>nlme</strong> package.</p>
<p>The function takes as input two <strong>nlme</strong> models, the input variable <code>model</code> is the full model then <code>model_r</code> should be the model with the variables removed that we want to test for significance in the model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Box_correction_modified_nlme</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">model_r</span>, <span class="va">data</span>, <span class="va">Sigma</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Design matrix for full model</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">model</span>,data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Response variable vector</span></span>
<span>  <span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getResponse.html">getResponse</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span>  </span>
<span>  <span class="co"># Design matrix for model with removed variables</span></span>
<span>  <span class="va">X_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">model_r</span>,data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="co"># Number of observations</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="co"># Number of variables</span></span>
<span>  <span class="va">parm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="co"># Number of variables being removed</span></span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X_r</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="co"># Have added option for Sigma to be chosen manually, this is needed for the Guinea pig example.</span></span>
<span>  <span class="co"># By default the function takes Sigma to be NULL, so will be NULL unless manually defined.</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>      <span class="co"># Need to find good way of extracting covariance matrix from model</span></span>
<span>        <span class="co"># Put in if statement to deal with models with no correlated errors</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">modelStruct</span><span class="op">$</span><span class="va">corStruct</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        </span>
<span>        <span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="co"># repeats = as.numeric(levels(model$groups))</span></span>
<span>        </span>
<span>        <span class="co"># Creating block matrix for model with correlated errors</span></span>
<span>        <span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getVarCov.html">getVarCov</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"marginal"</span><span class="op">)</span></span>
<span>        <span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html">%x%</a></span> <span class="va">Sigma</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ind</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">Sigma</span> <span class="op">=</span> <span class="va">Sigma</span><span class="op">[</span><span class="op">-</span><span class="va">ind</span>,<span class="op">-</span><span class="va">ind</span><span class="op">]</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>     </span>
<span>    <span class="op">}</span></span>
<span>     </span>
<span>  </span>
<span>  <span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span> <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">B</span> <span class="op">=</span> <span class="op">(</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span> <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">)</span>  <span class="op">-</span>  <span class="op">(</span> <span class="va">X_r</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_r</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X_r</span> <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X_r</span><span class="op">)</span> <span class="op">)</span> </span>
<span>  </span>
<span>  <span class="va">trace</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">V</span> <span class="op">=</span> <span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="op">(</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="op">(</span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>   </span>
<span>  </span>
<span>  </span>
<span>  <span class="va">v_2</span> <span class="op">=</span> <span class="op">(</span><span class="va">c</span><span class="op">*</span><span class="op">(</span><span class="fl">4</span><span class="op">*</span><span class="va">V</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">c</span><span class="op">*</span><span class="va">V</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">lambda</span> <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">parm</span><span class="op">)</span><span class="op">/</span><span class="va">c</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">v_2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">v_2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">F_</span> <span class="op">=</span>  <span class="op">(</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">parm</span><span class="op">)</span><span class="op">/</span><span class="va">c</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">F_mod</span> <span class="op">=</span> <span class="va">F_</span><span class="op">/</span><span class="va">lambda</span></span>
<span>  </span>
<span>  <span class="va">p_value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span>df1 <span class="op">=</span> <span class="va">c</span>, df2 <span class="op">=</span> <span class="va">v_2</span>, q <span class="op">=</span>  <span class="va">F_mod</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">F_</span>, <span class="va">F_mod</span>, <span class="va">c</span>, <span class="va">v_2</span>, <span class="va">p_value</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lambda"</span>, <span class="st">"F_"</span>,<span class="st">"F_MOD"</span>, <span class="st">"v1_MOD"</span>, <span class="st">"v2_mod"</span>, <span class="st">"prob_F_mod"</span><span class="op">)</span></span>
<span>  <span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">values</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">as.table</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>In your R session run this code so that you then have the function in your R environment.</p>
<p>Next we give some examples of using the function to recreate results presented in the second paper.</p>
</div>
<div id="examples" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Examples<a class="anchor" aria-label="anchor" href="#examples"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we look at recreating the examples given in section 6 of the second paper.</p>
<div id="cardiac-enzyme" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Cardiac enzyme<a class="anchor" aria-label="anchor" href="#cardiac-enzyme"><i class="fas fa-link"></i></a>
</h3>
<p>This example is covered in Section 6.1 of the second paper<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="citation"&gt;Skene and Kenward&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;'><sup>3</sup></a>. Section 6.1 of the paper applies the modified Box correction twice to this dataset, once with the original versiona and after including artificial dropouts to the dataset.</p>
<p>Importing the dataset, and converting a selection of variables to factors.
<strong>Need to select way for people to download file, should just make Github repo with csv file.</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cardiac_enzyme_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data_Images_Figures/The Cardiac Enzyme Data - Reduced Data set.csv"</span><span class="op">)</span></span>
<span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">dog</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">dog</span><span class="op">)</span></span>
<span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">trt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span></span>
<span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Cardiac_enzyme_data</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></code></pre></div>
<p>Here we are creating the <strong>nlme</strong> models. In this examples I have set <code>glsControl(tolerance = 10^-8)</code>, this is too match the convergence criteria used by <strong>nlme</strong> to the default convergence criteria used by PROC MIXED in SAS.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/glsControl.html">glsControl</a></span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">atp</span> <span class="op">~</span>  <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">time</span>,</span>
<span>            data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span>,</span>
<span>            correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>            weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">atp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span>,</span>
<span>              data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span>,</span>
<span>              correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>              weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can compare the results from the <code>Box_correction_modified_nlme()</code> function results given in the upper panel of Table VII in the second paper.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Box_correction_modified_nlme</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span>, model <span class="op">=</span> <span class="va">model</span>, model_r <span class="op">=</span> <span class="va">model_r</span><span class="op">)</span></span></code></pre></div>
<p>In addition to computing the p-value using the modified Box corrected F statistic, we can use the <strong>lmerTest</strong> package to compute some of the other p-values in Table VII.</p>
<p>The other p-values are computed using Wald tests with the Kenward-Roger adjustment.</p>
<p>Here we</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR">lmerTest</a></span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">=</span> <span class="fu">lmerTest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">atp</span> <span class="op">~</span>  <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>              data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1</span> <span class="op">=</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">atp</span> <span class="op">~</span>  <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>              data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">m1</span>, ddf <span class="op">=</span> <span class="st">"Kenward-Roger"</span><span class="op">)</span></span></code></pre></div>
<p>The anova method for the S3 method for class ‘lmerModLmerTest’ uses the KRmodcomp function from the pbkrtest package. And as an alternative to the previous method we can use the KRmodcomp function directly.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://people.math.aau.dk/~sorenh/software/pbkrtest/">pbkrtest</a></span><span class="op">)</span></span>
<span><span class="va">m0</span> <span class="op">=</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">atp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pbkrtest/man/kr-modcomp.html">KRmodcomp</a></span><span class="op">(</span><span class="va">m1</span>,<span class="va">m0</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="cardiac-enzyme---artifical-missing-data" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Cardiac enzyme - Artifical missing data<a class="anchor" aria-label="anchor" href="#cardiac-enzyme---artifical-missing-data"><i class="fas fa-link"></i></a>
</h3>
<p>The results in the lower panel of Table VII are computed by applying the same method to the same dataset but now with artificial missing data introduced.</p>
<p>The <code>Box_correction_modified_nlme()</code> function works with missing data.</p>
<p>Below we give the R code to compute these results.</p>
<p>We first introduce the missing data points to the <code>Cardiac_enzyme_data</code> used in the previous section.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cardiac_enzyme_data_miss</span> <span class="op">=</span> <span class="va">Cardiac_enzyme_data</span></span>
<span><span class="va">Cardiac_enzyme_data_miss</span><span class="op">$</span><span class="va">atp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">Cardiac_enzyme_data_miss</span><span class="op">$</span><span class="va">dog</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/glsControl.html">glsControl</a></span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">atp</span> <span class="op">~</span>  <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">time</span>,</span>
<span>            data <span class="op">=</span> <span class="va">Cardiac_enzyme_data_miss</span>,</span>
<span>            correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>            weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">time</span><span class="op">)</span>, na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">atp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">time</span>,</span>
<span>              data <span class="op">=</span> <span class="va">Cardiac_enzyme_data_miss</span>,</span>
<span>              correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">|</span><span class="va">dog</span><span class="op">)</span>,</span>
<span>              weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span><span class="op">~</span> <span class="fl">1</span><span class="op">|</span><span class="va">time</span><span class="op">)</span>, na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">Box_correction_modified_nlme</span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, model_r <span class="op">=</span> <span class="va">model_r</span>, data <span class="op">=</span> <span class="va">Cardiac_enzyme_data_miss</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="guinea-pigs" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Guinea pigs<a class="anchor" aria-label="anchor" href="#guinea-pigs"><i class="fas fa-link"></i></a>
</h3>
<p>Importing the dataset.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Guinea_pigs_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data_Images_Figures/brammer.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Guinea_pigs_data</span><span class="op">$</span><span class="va">conc.f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Guinea_pigs_data</span><span class="op">$</span><span class="va">conc.f</span><span class="op">)</span></span></code></pre></div>
<p>For this example <span class="citation">Skene and Kenward<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></span> used the sample covariance matrix as an estimator of the covariance matrix (<span class="math inline">\(\Sigma\)</span>). Therefore the sample covariance estimates are computed and then are used as inputs for <code>Sigma</code> in the <code>Box_correction_modified_nlme()</code> function.</p>
<p>Calculating the sample covariance matrices.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_compound_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">21</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sigma_compound_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">Guinea_pigs_data</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">21</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span> <span class="co">#no. subjects</span></span>
<span></span>
<span><span class="va">sigma_compound_1_block</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html">%x%</a></span> <span class="va">sigma_compound_1</span></span>
<span><span class="va">sigma_compound_2_block</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html">%x%</a></span> <span class="va">sigma_compound_2</span></span></code></pre></div>
<p>Creating the models.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_AP1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">AP1</span><span class="op">~</span><span class="va">conc.f</span>,data<span class="op">=</span><span class="va">Guinea_pigs_data</span><span class="op">)</span></span>
<span><span class="va">model_AP1_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">AP1</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">Guinea_pigs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_AP2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">AP2</span><span class="op">~</span><span class="va">conc.f</span>,data<span class="op">=</span><span class="va">Guinea_pigs_data</span><span class="op">)</span></span>
<span><span class="va">model_AP2_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">AP2</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">Guinea_pigs_data</span><span class="op">)</span></span></code></pre></div>
<p>Running the <code>Box_correction_modified_nlme()</code> function.</p>
<ul>
<li>For compound 1.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Box_correction_modified_nlme</span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_AP1</span>, model_r <span class="op">=</span> <span class="va">model_AP1_r</span>, data <span class="op">=</span> <span class="va">Guinea_pigs_data</span>, Sigma <span class="op">=</span> <span class="va">sigma_compound_1_block</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>For compound 2.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Box_correction_modified_nlme</span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_AP2</span>, model_r <span class="op">=</span> <span class="va">model_AP2_r</span>, data <span class="op">=</span> <span class="va">Guinea_pigs_data</span>, Sigma <span class="op">=</span> <span class="va">sigma_compound_2_block</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="Modified-Box-Correction-SAS.html"><span class="header-section-number">2</span> Modified Box Correction</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modified-box-correction"><span class="header-section-number">3</span> Modified Box Correction</a></li>
<li><a class="nav-link" href="#nlme"><span class="header-section-number">3.1</span> nlme</a></li>
<li>
<a class="nav-link" href="#examples"><span class="header-section-number">3.2</span> Examples</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cardiac-enzyme"><span class="header-section-number">3.2.1</span> Cardiac enzyme</a></li>
<li><a class="nav-link" href="#cardiac-enzyme---artifical-missing-data"><span class="header-section-number">3.2.2</span> Cardiac enzyme - Artifical missing data</a></li>
<li><a class="nav-link" href="#guinea-pigs"><span class="header-section-number">3.2.3</span> Guinea pigs</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/02-mod_box_R.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/02-mod_box_R.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Methods in (Skene &amp; Kenward, 2010)</strong>" was written by Dylan Dijk. It was last built on 2022-08-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
