--- 
title: "Methods in (Skene & Kenward, 2010)"
author: "Dylan Dijk"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This is a minimal example of using the bookdown package to write a book.
  The HTML output format for this example is bookdown::bs4_book,
  set in the _output.yml file.
biblio-style: apalike
csl: chicago-fullnote-bibliography.csl
---

<!-- I have followed the bookdown documentation found at https://bookdown.org/yihui/bookdown/ to make this.  -->

<!-- This section from this tutorial has been useful https://happygitwithr.com/bookdown-cheat-sheet.html -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE)
```

<!-- When I want to link to GitHub repository look at section 3.1.2.7 in Bookdown documentation -->

```{r eval=FALSE, echo = FALSE}
bookdown::serve_book()
```

```{r eval=FALSE}
servr::daemon_stop(1)
```


# Introduction

This tutorial aims to show how methods described in the two papers by @skene_analysis_2010_I^,^^[@skene_analysis_2010_II] can be applied with mixed models in [R](#R) or in [SAS](#SAS). For the rest of this tutorial we will refer to these two papers as paper I and paper II respectively.

## In particular we will focus on: 

### Modified Box Correction
The Box correction is a correction of the one way ANOVA $F$-statistic which follows an $F$ distribution under the assumptions of independent equally variable Gaussian errors. The Box correction $\psi^{-1}$$F$ then follows an $F$ distribution under the more general model where the Gaussian errors no longer are restricted to being independent and equally variable.

In the **Modified Box Correction** we treat the ratio of quadratic forms as a scaled $F$-statistic instead of a ratio of independent chi-squared distributions. The Modified Box Correction is preferred to Boxâ€™s original statistic which is conservative and hence less powerful. 

In order to compute the Modified Box Correction we require a consistent estimator of the covariance matrix $\Sigma$. For example, you could use the **OLS** covariance estimate. However, in most software that fit mixed models the **REML** estimator of the covariance matrix is used and is therefore often easier to compute. The ideal case is to compute the unstructured REML estimate, but when this is not possible we can compute an estimate of $\Sigma$ with the most complex structure the data will support.

In addition it is also possible to use an empirical estimator such as the sample  covariance matrix, an example of this is shown in Section 6.2 of paper II. We show how the results for this example can be recreated using R in section \@ref(Guinea-pigs).

    
    
    
### Scheffe contrast
  
### *Can add more*

***

## SAS {#SAS-Intro}

The analysis for these two papers were carried out using SAS. In particular the procedure **PROC MIXED** is used to calculate an estimator of the covariance matrix. SAS provides [documentation](https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_mixed_toc.htm "SAS PROC MIXED documentation") for **PROC MIXED**, in the [overview section](https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_mixed_overview.htm) in the penultimate paragraph it describes how this SAS procedure  fits the structure you select to the data by using the method of restricted maximum likelihood (REML).
  
***  
  
## R {#R-Intro}

There are multiple packages in R that allow you to fit mixed models. The most popular are the **nlme** and **lme4** package. Some of the differences between the two packages are described on page 4 of the **lme4** package [documentation](https://cran.r-project.org/web/packages/lme4/lme4.pdf "lme4 R package documentation"). 

The main difference is that the **nlme** package allows more flexibility in choosing complex variance-covariance structures. With the **lme4** package only allowing us to select the correlation structure between individuals via the random effects (G side).

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```
